# Description: Freedesktop.org message bus system
# URL: http://www.freedesktop.org/wiki/Software/dbus/
# Packager: pierre at nutyx dot org
# Depends on: expat xorg-libx11 xorg-libsm xorg-libice 
PKGMK_GROUPS=(doc devel)

name=dbus
version=1.10.6
release=1

source=(http://dbus.freedesktop.org/releases/dbus/$name-$version.tar.gz \
       dbus.system-local.conf)
       
PKGMK_GROUPS=(man doc)       

build() {
	cd $name-$version
	./configure --prefix=/usr                        \
              --sysconfdir=/etc                   	 \
              --localstatedir=/var                	 \
              --disable-static                    	 \
              --disable-doxygen-docs              	 \
              --disable-xml-docs                  	 \
              --docdir=/usr/share/doc/$name-$version \
              --with-console-auth-dir=/run/console
	make
	make DESTDIR=$PKG install
mkdir -p $PKG/lib
mv -v $PKG/usr/lib/libdbus-1.so.* $PKG/lib
ln -svf ../../lib/libdbus.so.$version $PKG/usr/lib/libdbus-1.so
mkdir -p $PKG/var/lib	
ln -sfv /etc/machine-id $PKG/var/lib/dbus
}
devel () {
cd $PKG
bsdtar -cf \
$PKGMK_PACKAGE_DIR/${name}.devel${PKGMK_BUILDVER}`uname -m`.$PKGMK_PACKAGE_EXT \
usr/lib usr/include
rm -rvf usr/lib usr/include
}
